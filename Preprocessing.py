import numpy as np
import pandas as pd
from sklearn.preprocessing import LabelEncoder
labelencoder = LabelEncoder()

def preprocess(df, option):
    
    def binary_map(feature):
        return feature.map({'Yes':1, 'No':0})   
    
    if (option == 'Online'):
    
        binary_list = ['warranty','general_inspection','non_smoker_vehicle','paint','bdt_Compact','bdt_Convertible','bdt_Coupe','bdt_Off-Road/Pick-up','bdt_Panel van','bdt_Sedan','bdt_Station wagon','bdt_Transporter','bdt_Van','gb_Automatic','gb_Manual','gb_Semi-automatic','cc_360° camera','cc_Air conditioning','cc_Air suspension','cc_Armrest','cc_Automatic climate control','cc_Automatic climate control 2 zones','cc_Automatic climate control 3 zones','cc_Automatic climate control 4 zones','cc_Auxiliary heating','cc_Cruise control','cc_Electric backseat adjustment','cc_Electric tailgate','cc_Electrical side mirrors','cc_Electrically adjustable seats','cc_Electrically heated windshield','cc_Fold flat passenger seat','cc_Heads-up display','cc_Heated steering wheel','cc_Hill Holder','cc_Keyless central door lock','cc_Leather seats','cc_Leather steering wheel','cc_Light sensor','cc_Lumbar support','cc_Massage seats','cc_Multi-function steering wheel','cc_Navigation system','cc_Panorama roof','cc_Park Distance Control','cc_Parking assist system camera','cc_Parking assist system self-steering','cc_Parking assist system sensors front','cc_Parking assist system sensors rear','cc_Power windows','cc_Rain sensor','cc_Seat heating','cc_Seat ventilation','cc_Sliding door left','cc_Sliding door right','cc_Split rear seats','cc_Start-stop system','cc_Sunroof','cc_Tinted windows','cc_Wind deflector','type_Antique/Classic','type_Demonstration','type_New','type_Pre-registered','type_Used','cyl_1','cyl_10','cyl_12','cyl_2','cyl_3','cyl_4','cyl_5','cyl_6','cyl_7','cyl_8','doors_1','doors_2','doors_3','doors_4','doors_5','doors_6','clr_Beige','clr_Black','clr_Blue','clr_Bronze','clr_Brown','clr_Gold','clr_Green','clr_Grey','clr_Orange','clr_Red','clr_Silver','clr_Violet','clr_White','clr_Yellow','grs_1','grs_2','grs_3','grs_4','grs_5','grs_6','grs_7','grs_8','grs_9','ext_All season tyres','ext_Alloy wheels','ext_Ambient lighting','ext_Automatically dimming interior mirror','ext_Awning','ext_Biodiesel conversion','ext_Cargo barrier','ext_Catalytic Converter','ext_E10-enabled','ext_Electronic parking brake','ext_Emergency tyre','ext_Emergency tyre repair kit','ext_Handicapped enabled','ext_Headlight washer system','ext_Range extender','ext_Right hand drive','ext_Roof rack','ext_Shift paddles','ext_Ski bag','ext_Sliding door','ext_Smokers package','ext_Spare tyre','ext_Spoiler','ext_Sport package','ext_Sport seats','ext_Sport suspension','ext_Steel wheels','ext_Summer tyres','ext_Touch screen','ext_Trailer hitch','ext_Tuned car','ext_Voice Control','ext_Winter package','ext_Winter tyres','em_Android Auto','em_Apple CarPlay','em_Bluetooth','em_CD player','em_Digital cockpit','em_Digital radio','em_Hands-free equipment','em_Induction charging for smartphones','em_Integrated music streaming','em_MP3','em_On-board computer','em_Radio','em_Sound system','em_Television','em_USB','em_WLAN / WiFi hotspot','dt_4WD','dt_Front','dt_Rear','fuelt_CNG','fuelt_Diesel','fuelt_Electric','fuelt_Electric/Diesel','fuelt_Electric/Gasoline','fuelt_Ethanol','fuelt_Gasoline','fuelt_Hydrogen','fuelt_LPG','up_Alcantara','up_Cloth','up_Full leather','up_Part leather','up_Velour','upClr_Beige','upClr_Black','upClr_Blue','upClr_Brown','upClr_Green','upClr_Grey','upClr_Orange','upClr_Red','upClr_White','upClr_Yellow','seats_Beige','seats_Black','seats_Blue','seats_Brown','seats_Green','seats_Grey','seats_Orange','seats_Red','seats_White','seats_Yellow','EmClass_Euro 1','EmClass_Euro 2','EmClass_Euro 3','EmClass_Euro 4','EmClass_Euro 5','EmClass_Euro 6','ss_ABS','ss_Adaptive Cruise Control','ss_Adaptive headlights','ss_Alarm system','ss_Bi-Xenon headlights','ss_Blind spot monitor','ss_Central door lock','ss_Central door lock with remote control','ss_Daytime running lights','ss_Distance warning system','ss_Driver drowsiness detection','ss_Driver-side airbag','ss_Electronic stability control','ss_Emergency brake assistant','ss_Emergency system','ss_Fog lights','ss_Full-LED headlights','ss_Glare-free high beam headlights','ss_Head airbag','ss_High beam assist','ss_Immobilizer','ss_Isofix','ss_LED Daytime Running Lights','ss_LED Headlights','ss_Lane departure warning system','ss_Laser headlights','ss_Night view assist','ss_Passenger-side airbag','ss_Power steering','ss_Rear airbag','ss_Side airbag','ss_Speed limit control system','ss_Tire pressure monitoring system','ss_Traction control','ss_Traffic sign recognition','ss_Xenon headlights'] 
    
        df[binary_list]=df[binary_list].apply(binary_map)
    
        columns=['mileage','warranty','first_registration','general_inspection','non_smoker_vehicle','Power','engine_size','cylinders','empty_weight','co2_emissions','paint','make_model','fuel_con_comb','bdt_Compact','bdt_Convertible','bdt_Coupe','bdt_Off-Road/Pick-up','bdt_Panel van','bdt_Sedan','bdt_Station wagon','bdt_Transporter','bdt_Van','gb_Automatic','gb_Manual','gb_Semi-automatic','age','cc_360° camera','cc_Air conditioning','cc_Air suspension','cc_Armrest','cc_Automatic climate control','cc_Automatic climate control 2 zones','cc_Automatic climate control 3 zones','cc_Automatic climate control 4 zones','cc_Auxiliary heating','cc_Cruise control','cc_Electric backseat adjustment','cc_Electric tailgate','cc_Electrical side mirrors','cc_Electrically adjustable seats','cc_Electrically heated windshield','cc_Fold flat passenger seat','cc_Heads-up display','cc_Heated steering wheel','cc_Hill Holder','cc_Keyless central door lock','cc_Leather seats','cc_Leather steering wheel','cc_Light sensor','cc_Lumbar support','cc_Massage seats','cc_Multi-function steering wheel','cc_Navigation system','cc_Panorama roof','cc_Park Distance Control','cc_Parking assist system camera','cc_Parking assist system self-steering','cc_Parking assist system sensors front','cc_Parking assist system sensors rear','cc_Power windows','cc_Rain sensor','cc_Seat heating','cc_Seat ventilation','cc_Sliding door left','cc_Sliding door right','cc_Split rear seats','cc_Start-stop system','cc_Sunroof','cc_Tinted windows','cc_Wind deflector','type_Antique/Classic','type_Demonstration','type_New','type_Pre-registered','type_Used','cyl_1','cyl_10','cyl_12','cyl_2','cyl_3','cyl_4','cyl_5','cyl_6','cyl_7','cyl_8','doors_1','doors_2','doors_3','doors_4','doors_5','doors_6','clr_Beige','clr_Black','clr_Blue','clr_Bronze','clr_Brown','clr_Gold','clr_Green','clr_Grey','clr_Orange','clr_Red','clr_Silver','clr_Violet','clr_White','clr_Yellow','grs_1','grs_2','grs_3','grs_4','grs_5','grs_6','grs_7','grs_8','grs_9','mileage_digitized','ext_All season tyres','ext_Alloy wheels','ext_Ambient lighting','ext_Automatically dimming interior mirror','ext_Awning','ext_Biodiesel conversion','ext_Cargo barrier','ext_Catalytic Converter','ext_E10-enabled','ext_Electronic parking brake','ext_Emergency tyre','ext_Emergency tyre repair kit','ext_Handicapped enabled','ext_Headlight washer system','ext_Range extender','ext_Right hand drive','ext_Roof rack','ext_Shift paddles','ext_Ski bag','ext_Sliding door','ext_Smokers package','ext_Spare tyre','ext_Spoiler','ext_Sport package','ext_Sport seats','ext_Sport suspension','ext_Steel wheels','ext_Summer tyres','ext_Touch screen','ext_Trailer hitch','ext_Tuned car','ext_Voice Control','ext_Winter package','ext_Winter tyres','em_Android Auto','em_Apple CarPlay','em_Bluetooth','em_CD player','em_Digital cockpit','em_Digital radio','em_Hands-free equipment','em_Induction charging for smartphones','em_Integrated music streaming','em_MP3','em_On-board computer','em_Radio','em_Sound system','em_Television','em_USB','em_WLAN / WiFi hotspot','dt_4WD','dt_Front','dt_Rear','fuelt_CNG','fuelt_Diesel','fuelt_Electric','fuelt_Electric/Diesel','fuelt_Electric/Gasoline','fuelt_Ethanol','fuelt_Gasoline','fuelt_Hydrogen','fuelt_LPG','up_Alcantara','up_Cloth','up_Full leather','up_Part leather','up_Velour','upClr_Beige','upClr_Black','upClr_Blue','upClr_Brown','upClr_Green','upClr_Grey','upClr_Orange','upClr_Red','upClr_White','upClr_Yellow','seats_Beige','seats_Black','seats_Blue','seats_Brown','seats_Green','seats_Grey','seats_Orange','seats_Red','seats_White','seats_Yellow','EmClass_Euro 1','EmClass_Euro 2','EmClass_Euro 3','EmClass_Euro 4','EmClass_Euro 5','EmClass_Euro 6','ss_ABS','ss_Adaptive Cruise Control','ss_Adaptive headlights','ss_Alarm system','ss_Bi-Xenon headlights','ss_Blind spot monitor','ss_Central door lock','ss_Central door lock with remote control','ss_Daytime running lights','ss_Distance warning system','ss_Driver drowsiness detection','ss_Driver-side airbag','ss_Electronic stability control','ss_Emergency brake assistant','ss_Emergency system','ss_Fog lights','ss_Full-LED headlights','ss_Glare-free high beam headlights','ss_Head airbag','ss_High beam assist','ss_Immobilizer','ss_Isofix','ss_LED Daytime Running Lights','ss_LED Headlights','ss_Lane departure warning system','ss_Laser headlights','ss_Night view assist','ss_Passenger-side airbag','ss_Power steering','ss_Rear airbag','ss_Side airbag','ss_Speed limit control system','ss_Tire pressure monitoring system','ss_Traction control','ss_Traffic sign recognition','ss_Xenon headlights']
    
        df = pd.get_dummies(df).reindex(columns=columns, fill_value=0)
        
    elif (option == "Batch"):
        # df.drop(labels = ['Unnamed: 0', 'price'], axis = 1, inplace = True)
        columns=['mileage','warranty','first_registration','general_inspection','non_smoker_vehicle','Power','engine_size','cylinders','empty_weight','co2_emissions','paint','make_model','fuel_con_comb','bdt_Compact','bdt_Convertible','bdt_Coupe','bdt_Off-Road/Pick-up','bdt_Panel van','bdt_Sedan','bdt_Station wagon','bdt_Transporter','bdt_Van','gb_Automatic','gb_Manual','gb_Semi-automatic','age','cc_360° camera','cc_Air conditioning','cc_Air suspension','cc_Armrest','cc_Automatic climate control','cc_Automatic climate control 2 zones','cc_Automatic climate control 3 zones','cc_Automatic climate control 4 zones','cc_Auxiliary heating','cc_Cruise control','cc_Electric backseat adjustment','cc_Electric tailgate','cc_Electrical side mirrors','cc_Electrically adjustable seats','cc_Electrically heated windshield','cc_Fold flat passenger seat','cc_Heads-up display','cc_Heated steering wheel','cc_Hill Holder','cc_Keyless central door lock','cc_Leather seats','cc_Leather steering wheel','cc_Light sensor','cc_Lumbar support','cc_Massage seats','cc_Multi-function steering wheel','cc_Navigation system','cc_Panorama roof','cc_Park Distance Control','cc_Parking assist system camera','cc_Parking assist system self-steering','cc_Parking assist system sensors front','cc_Parking assist system sensors rear','cc_Power windows','cc_Rain sensor','cc_Seat heating','cc_Seat ventilation','cc_Sliding door left','cc_Sliding door right','cc_Split rear seats','cc_Start-stop system','cc_Sunroof','cc_Tinted windows','cc_Wind deflector','type_Antique/Classic','type_Demonstration','type_New','type_Pre-registered','type_Used','cyl_1','cyl_10','cyl_12','cyl_2','cyl_3','cyl_4','cyl_5','cyl_6','cyl_7','cyl_8','doors_1','doors_2','doors_3','doors_4','doors_5','doors_6','clr_Beige','clr_Black','clr_Blue','clr_Bronze','clr_Brown','clr_Gold','clr_Green','clr_Grey','clr_Orange','clr_Red','clr_Silver','clr_Violet','clr_White','clr_Yellow','grs_1','grs_2','grs_3','grs_4','grs_5','grs_6','grs_7','grs_8','grs_9','mileage_digitized','ext_All season tyres','ext_Alloy wheels','ext_Ambient lighting','ext_Automatically dimming interior mirror','ext_Awning','ext_Biodiesel conversion','ext_Cargo barrier','ext_Catalytic Converter','ext_E10-enabled','ext_Electronic parking brake','ext_Emergency tyre','ext_Emergency tyre repair kit','ext_Handicapped enabled','ext_Headlight washer system','ext_Range extender','ext_Right hand drive','ext_Roof rack','ext_Shift paddles','ext_Ski bag','ext_Sliding door','ext_Smokers package','ext_Spare tyre','ext_Spoiler','ext_Sport package','ext_Sport seats','ext_Sport suspension','ext_Steel wheels','ext_Summer tyres','ext_Touch screen','ext_Trailer hitch','ext_Tuned car','ext_Voice Control','ext_Winter package','ext_Winter tyres','em_Android Auto','em_Apple CarPlay','em_Bluetooth','em_CD player','em_Digital cockpit','em_Digital radio','em_Hands-free equipment','em_Induction charging for smartphones','em_Integrated music streaming','em_MP3','em_On-board computer','em_Radio','em_Sound system','em_Television','em_USB','em_WLAN / WiFi hotspot','dt_4WD','dt_Front','dt_Rear','fuelt_CNG','fuelt_Diesel','fuelt_Electric','fuelt_Electric/Diesel','fuelt_Electric/Gasoline','fuelt_Ethanol','fuelt_Gasoline','fuelt_Hydrogen','fuelt_LPG','up_Alcantara','up_Cloth','up_Full leather','up_Part leather','up_Velour','upClr_Beige','upClr_Black','upClr_Blue','upClr_Brown','upClr_Green','upClr_Grey','upClr_Orange','upClr_Red','upClr_White','upClr_Yellow','seats_Beige','seats_Black','seats_Blue','seats_Brown','seats_Green','seats_Grey','seats_Orange','seats_Red','seats_White','seats_Yellow','EmClass_Euro 1','EmClass_Euro 2','EmClass_Euro 3','EmClass_Euro 4','EmClass_Euro 5','EmClass_Euro 6','ss_ABS','ss_Adaptive Cruise Control','ss_Adaptive headlights','ss_Alarm system','ss_Bi-Xenon headlights','ss_Blind spot monitor','ss_Central door lock','ss_Central door lock with remote control','ss_Daytime running lights','ss_Distance warning system','ss_Driver drowsiness detection','ss_Driver-side airbag','ss_Electronic stability control','ss_Emergency brake assistant','ss_Emergency system','ss_Fog lights','ss_Full-LED headlights','ss_Glare-free high beam headlights','ss_Head airbag','ss_High beam assist','ss_Immobilizer','ss_Isofix','ss_LED Daytime Running Lights','ss_LED Headlights','ss_Lane departure warning system','ss_Laser headlights','ss_Night view assist','ss_Passenger-side airbag','ss_Power steering','ss_Rear airbag','ss_Side airbag','ss_Speed limit control system','ss_Tire pressure monitoring system','ss_Traction control','ss_Traffic sign recognition','ss_Xenon headlights']
        df = pd.get_dummies(df).reindex(columns=columns, fill_value=0)
        
    else:
        print('Incorrect operational options')
        
    return df

    

    